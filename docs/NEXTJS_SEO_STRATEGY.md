# Next.js SEO Strategy

## Goal
- Replace the Vite specific extractor scripts with native Next.js rendering that keeps full marketing copy visible in the rendered HTML.
- Preserve route level metadata control while aligning with the Next.js Metadata API.
- Maintain or improve current SEO visibility metrics that rely on view-page-source completeness.
- Keep breadcrumb schema and other structured navigation cues identical to the current implementation.
- Produce an output compatible with Render's dynamic web app hosting model.

## Key Principles
1. **Static HTML First**: Use Next.js static generation so that every route emits fully rendered HTML with the marketing copy already present. No additional extractor scripts required.
2. **Dynamic Metadata**: Leverage `generateMetadata` for dynamic routes so location pages still receive custom titles, descriptions, and canonical URLs.
3. **Structured Data Preservation**: Output existing schema blocks through server components or metadata `other` fields to keep structured data intact, including breadcrumb lists.
4. **Hidden Content Replacement**: Replace the `.complete-seo-content` hidden divs with server rendered sections that remain in the HTML but use utility classes to visually hide content when needed.
5. **Backwards Compatible Rollout**: Keep the Express SEO server online until Next.js output is validated against current extractor content size benchmarks.
6. **Natural Rendering**: Ensure all marketing copy appears in the standard DOM tree so each page loads dynamically with visible content without relying on post-processing scripts.

## Implementation Overview
1. **Content Rendering**
   - Convert each page to a server component that returns the full marketing copy.
   - When content must remain hidden from the visual layout, wrap it with a Tailwind utility such as `sr-only` or a dedicated class that hides content without removing it from the DOM.
2. **Metadata Generation**
   - For static pages, export a `metadata` object containing title, description, open graph, and twitter data.
   - For dynamic routes like `ai-seo-agency/[location]`, implement `generateStaticParams` to prebuild all locations and use `generateMetadata` to derive strings from the location dataset, including breadcrumb nodes.
3. **Structured Data Injection**
   - Add JSON-LD via React fragments inside server components, using `<script type="application/ld+json">` with `dangerouslySetInnerHTML`.
   - Store shared schema definitions in `/lib/seo` for reuse across routes.
4. **Canonical URLs and Alternate Links**
   - Use the Metadata API `alternates` field to declare canonical URLs.
   - Add regional or language specific alternates when the content map expands.
   - Keep breadcrumb schema aligned with the generated canonical paths.
5. **Headless CMS Compatibility**
   - Abstract metadata and schema builders into utility functions so future CMS integrations can supply the data without rewriting the plumbing.

## Migration Steps
1. Document the current extractor output counts for every route (already tracked in `SEO-CONTENT-SYSTEM-INSTRUCTIONS.md` and summarized in `docs/NEXTJS_PHASE0_BASELINE.md`).
2. During Phase 3 of the migration plan, create a proof of concept Next.js route that reproduces one location page with full content rendered statically.
3. Validate the rendered HTML in view source and compare text counts against the extractor output.
4. Once parity is achieved, replicate the approach across all routes.
5. Remove extractor scripts and CSS hiding rules after production cutover and archive them in version control.

## Verification Checklist
- [ ] Each Next.js page renders full marketing copy without relying on client side hydration.
- [ ] Metadata values generated by the Metadata API match or exceed current Helmet outputs.
- [ ] JSON-LD blocks remain visible in the HTML source.
- [ ] Hidden content alternatives are accessible and pass accessibility audits.
- [ ] The Express SEO server is decommissioned only after live testing confirms consistent indexing.

## Hand-off Notes for Future Agents
- Update `docs/AI-INSTRUCTIONS-FOR-NEW-PAGES.md` once Next.js is live so new pages follow the server rendered pattern instead of adding extractor entries.
- Keep a running diff of rendered HTML between Vite and Next builds for the first few releases to catch regressions.
- Coordinate with stakeholders before removing the legacy extractor scripts in case rollback is required.
